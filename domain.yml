version: "3.1"

# 1. Define all intents
intents:
- greet
- goodbye
- bot_challenge
- check_balance
- inform_account_type
- ask_transfer_money
- affirm
- deny
- nlu_fallback
- ask_fees
- ask_loan_info

# 2. Define all entities
entities:
- account_type
- amount
- recipient

# 3. Define all slots
slots:
  account_type:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: account_type
    - type: from_text
      intent: inform_account_type

  recipient:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: recipient
    - type: from_text
      conditions:  # <-- This is the fix
      - active_loop: transfer_form
        requested_slot: recipient

  amount:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: amount
    - type: from_text
      conditions:  # <-- This is the fix
      - active_loop: transfer_form
        requested_slot: amount

# 4. Define bot responses
responses:
  utter_greet:
  - text: "Hello! I'm your banking assistant. How can I help you today?"
  utter_goodbye:
  - text: "Goodbye!"
  utter_iamabot:
  - text: "I am a bot, powered by Rasa."
  utter_ask_account_type:
  - text: "Which account would you like to check? Savings or Checking?"
  utter_show_balance:
  - text: "The balance for your {account_type} account is 1000."
  utter_confirm_transfer:
  - text: "Just to confirm, you want to send {amount} to {recipient}?"
  utter_transfer_complete:
  - text: "The transfer of {amount} to {recipient} is complete."
  utter_transfer_cancelled:
  - text: "Transfer cancelled."
  utter_out_of_scope:
  - text: "I'm sorry, I can only help with banking-related questions. How can I assist you with your accounts?"
  utter_explain_fees:
  - text: "We have a $5 monthly maintenance fee for checking accounts. Transfers are free."
  utter_explain_loan_info:
  - text: "We offer personal, home, and auto loans. Would you like more details on a specific one?"
  
  # Form responses
  utter_ask_recipient:
  - text: "Who would you like to send the money to?"
  utter_ask_amount:
  - text: "How much would you like to send?"

# 5. Define forms
forms:
  transfer_form:
    required_slots:
    - recipient
    - amount

